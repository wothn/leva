## 最新更新日志

### 2025年7月29日 - 简化为剑桥词典专用版本

**主要改动：**
1. **重构词典解析系统**
   - 移除牛津词典和柯林斯词典支持，专注于剑桥词典
   - 基于 example.html 的真实DOM结构重写解析逻辑
   - 整合解析功能到 offscreen.js，移除外部依赖

2. **优化解析准确性**
   - 精确解析英式/美式发音及音频链接
   - 准确提取词性、英文定义、中文翻译
   - 完整提取例句及其中文翻译
   - 基于实际剑桥词典页面结构的选择器

3. **改进界面显示**
   - 重新设计悬浮提示框样式，更好地展示剑桥词典内容
   - 优化深色模式支持
   - 改进发音标签和释义布局
   - 增强例句的可读性

4. **简化音频播放**
   - 针对剑桥词典音频URL结构优化备用方案
   - 减少不必要的音频源尝试
   - 提高音频播放成功率

5. **代码优化**
   - 简化配置系统，移除多词典切换逻辑
   - 减少代码复杂度，提高维护性
   - 优化错误处理和用户反馈

**技术细节：**
- 保留原有的生词收集、高亮显示等核心功能
- 维持与扩展其他组件的兼容性
- 添加测试页面 test.html 用于功能验证

## 项目初探指南

对于初次接触此项目的开发者，建议了解以下关键信息：

### 1. 项目概述
- 这是一个浏览器扩展项目，主要用于英语学习，特别是生词收集和管理
- 支持在浏览网页时收集生词，并提供高亮显示、悬浮释义等功能
- 基于 Chrome 扩展 API 开发，使用 Manifest V3 规范

### 2. 核心功能模块
- 生词收集与存储
- 单词高亮显示
- 悬浮释义查询
- 生词本管理
- 用户设置与自定义

### 3. 技术栈
- 前端：HTML, CSS, JavaScript
- 浏览器 API：Chrome Extension APIs (storage, contextMenus, activeTab等)
- 词典解析：使用 Offscreen API 解析 Cambridge Dictionary 网页

### 4. 代码结构
- `manifest.json` - 扩展配置文件
- `js/` - 包含各功能模块的JavaScript代码
- `css/` - 样式文件
- `popup.html` - 扩展弹出窗口界面
- `settings.html` - 设置界面
- `offscreen.html` - 用于后台解析词典网页

### 5. 开发环境搭建
- 需要支持Chrome扩展开发的浏览器（Chrome/Edge等）
- 推荐使用编辑器：VS Code
- 调试方式：通过浏览器的扩展管理页面加载未打包的扩展

### 6. 快速开始
1. 克隆项目代码
2. 在浏览器中打开扩展管理页面（chrome://extensions/）
3. 启用"开发者模式"
4. 点击"加载已解压的扩展程序"，选择项目根目录
5. 开始调试和开发

## 技术实现

### 1. 扩展配置（manifest.json）

- 使用 Manifest V3 格式
- 申请必要的权限：storage（存储生词）、contextMenus（右键菜单）、activeTab（访问当前标签页）
- 配置内容脚本、后台脚本和弹出页面
- 添加快捷键支持，用户可以通过 Ctrl+Shift+V 打开生词本弹窗，Ctrl+Shift+A 添加选中的单词

### 2. 生词收集功能

- 通过右键菜单选项实现单词收集
- 使用 Chrome Storage API 存储生词数据
- 收集成功时显示通知提醒
- 支持快捷键（Ctrl+Shift+A）快速添加选中的单词
- 支持浮动工具栏，在选中文本时出现添加按钮
- 工具栏显示可由用户在设置中开启/关闭

### 3. 高亮显示功能

- 使用正则表达式在网页上查找匹配的生词
- 通过 DOM 操作将找到的文本包装在带样式的 span 元素中
- 实现高亮显示的开关控制
- 支持多种高亮样式（下划线、背景色、边框）
- 支持自定义高亮颜色

### 4. 生词管理功能

- 在弹出窗口中展示收集的所有生词
- 提供搜索过滤功能
- 支持删除单个生词
- 支持一键清空所有生词
- 支持清空单词释义缓存
- 提供导出生词列表功能
- 提供设置页面，允许用户自定义功能选项

### 5. 设置功能

- 提供用户友好的设置界面
- 支持开启/关闭划词工具栏
- 支持自定义高亮样式（下划线、背景色、边框）
- 支持自定义高亮颜色
- 支持开启/关闭悬浮释义功能
- 支持开启/关闭深色模式
- 支持开启/关闭自动发音功能
- 支持自定义添加单词快捷键
- 设置即时生效，无需重启浏览器

### 6. 悬浮释义功能

- 当用户鼠标悬停在高亮单词上时触发释义查询
- **专注剑桥词典**：只使用剑桥词典获取单词的英汉/英英释义
- 使用 Offscreen API 解析词典网页提取关键信息
- 基于 example.html 结构优化的解析逻辑，确保准确提取：
  - 英式和美式发音（音标和音频）
  - 词性信息
  - 英文定义和中文翻译
  - 例句及其中文翻译
- 显示包含音标、多个释义和例句的悬浮提示框
- 实现缓存机制减少重复请求，提高性能
- 提供优雅的加载动画和精美的界面设计
- 根据页面布局智能定位悬浮提示框位置
- 悬浮释义功能可由用户在设置中开启/关闭
- 简化的音频播放备用方案，针对剑桥词典音频URL结构优化

## Tooltip（悬浮提示框）样式风格

悬浮提示框采用**简洁现代**的设计风格：

### 设计特点
- **极简主义**：去除多余装饰，突出内容本身
- **现代扁平化**：使用圆角边框、简洁线条和现代色彩
- **分层清晰**：通过背景色和边框区分不同内容区域
- **响应式适配**：支持亮色和暗色主题自动切换

### 色彩方案
- **亮色主题**：白色背景 `#ffffff`，浅灰蓝标题区 `#f8fafc`，深灰文字 `#1f2937`
- **暗色主题**：深蓝灰背景 `#1f2937`，更深标题区 `#111827`，浅色文字 `#f3f4f6`
- **强调色**：现代蓝紫色 `#6366f1` 用于交互元素

### 布局结构
垂直分层：标题区域 → 发音区域 → 释义区域 → 例句区域

### 视觉细节
- **圆角**：主容器 8px 圆角，内部元素 3-4px 小圆角
- **阴影**：`0 4px 12px rgba(0, 0, 0, 0.15)` 创造浮动感
- **动画**：0.2s 平滑过渡，显示时轻微向上移动效果
- **字体**：系统原生字体，16px 标题，13px 正文，12px 例句